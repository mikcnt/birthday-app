<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Birthday Surprise</title>
    <style>
        :root {
            --bg1: #0f1020;
            --bg2: #1b2a49;
            --card: rgba(255, 255, 255, 0.08);
            --text: rgba(255, 255, 255, 0.92);
            --muted: rgba(255, 255, 255, 0.7);
            --yes: #4ade80;
        }

        * {
            box-sizing: border-box;
        }

        body {
            margin: 0;
            font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
            color: var(--text);
            min-height: 100vh;
            display: grid;
            place-items: center;
            background: radial-gradient(1200px 600px at 20% 10%, #2a3a7a 0%, transparent 60%),
            radial-gradient(1000px 700px at 80% 90%, #0ea5e9 0%, transparent 55%),
            linear-gradient(135deg, var(--bg1), var(--bg2));
            overflow: hidden;
        }

        #dimOverlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.35);
            opacity: 0;
            pointer-events: none;
            transition: opacity 600ms ease;
            z-index: 4;
        }

        #dimOverlay.show {
            opacity: 1;
        }

        .card {
            width: min(560px, calc(100vw - 32px));
            background: var(--card);
            border: 1px solid rgba(255, 255, 255, 0.12);
            border-radius: 20px;
            padding: 22px 18px;
            box-shadow: 0 20px 80px rgba(0, 0, 0, 0.45);
            backdrop-filter: blur(10px);
            position: relative;
            z-index: 3;
        }

        .debug-bar {
            display: flex;
            gap: 8px;
            align-items: center;
            margin-bottom: 10px;
            font-size: 12px;
            color: rgba(255, 255, 255, 0.55);
        }

        .debug-bar button {
            padding: 6px 10px;
            font-size: 12px;
            font-weight: 700;
            box-shadow: none;
        }

        .debug-bar .label {
            margin-right: 6px;
        }

        #reveal {
            position: fixed;
            inset: 0;
            display: none;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            background: radial-gradient(900px 600px at 50% 20%, #3b82f6 0%, transparent 60%),
            linear-gradient(160deg, #0f1020, #111827);
            z-index: 5;
            text-align: center;
            color: #fff;
        }

        #reveal.show {
            display: flex;
        }

        #reveal h2 {
            font-size: clamp(40px, 8vw, 88px);
            margin: 0;
            letter-spacing: 1px;
        }

        #confetti {
            position: absolute;
            inset: 0;
            overflow: hidden;
            pointer-events: none;
        }

        .confetti-piece {
            position: absolute;
            width: 8px;
            height: 14px;
            opacity: 0.9;
            animation: confetti-fall 2.8s linear infinite;
        }

        @keyframes confetti-fall {
            0% {
                transform: translate3d(0, -10vh, 0) rotate(0deg);
                opacity: 0;
            }
            10% {
                opacity: 1;
            }
            100% {
                transform: translate3d(0, 110vh, 0) rotate(360deg);
                opacity: 0.9;
            }
        }

        h1 {
            font-size: 24px;
            margin: 0 0 8px 0;
            letter-spacing: 0.2px;
        }

        p {
            margin: 0 0 16px 0;
            color: var(--muted);
            line-height: 1.35;
            font-size: 15px;
            min-height: 40px;
        }

        .stage {
            position: relative;
            height: 240px;
            border-radius: 16px;
            border: 1px dashed rgba(255, 255, 255, 0.18);
            background: rgba(0, 0, 0, 0.12);
            overflow: hidden;
        }

        .buttons {
            position: absolute;
            inset: 0;
        }

        button {
            appearance: none;
            border: none;
            border-radius: 999px;
            padding: 14px 18px;
            font-weight: 800;
            font-size: 16px;
            cursor: pointer;
            user-select: none;
            -webkit-user-select: none;
            -webkit-touch-callout: none;
            touch-action: manipulation;
            box-shadow: 0 14px 30px rgba(0, 0, 0, 0.35);
            transform: translateZ(0);
            transition: transform 180ms ease;
        }

        #yesBtn {
            position: absolute;
            background: var(--yes);
            color: #0b1220;
            touch-action: none; /* prevents scroll while holding */
        }

        #yesBtn.neutral {
            background: rgba(255, 255, 255, 0.2);
            color: rgba(255, 255, 255, 0.85);
        }

        #yesBtn.smooth {
            transition: left 280ms ease, top 280ms ease, background-color 280ms ease,
            color 280ms ease, transform 180ms ease;
        }

        .progress {
            height: 10px;
            border-radius: 999px;
            overflow: hidden;
            background: rgba(255, 255, 255, 0.12);
            border: 1px solid rgba(255, 255, 255, 0.18);
            margin-top: 12px;
            display: none;
            position: relative;
        }

        .progress > div {
            height: 100%;
            width: 0%;
            background: rgba(255, 255, 255, 0.55);
        }

        .progress-label {
            display: none;
            margin-top: 6px;
            text-align: right;
            font-size: 10px;
            color: rgba(255, 255, 255, 0.7);
            letter-spacing: 0.3px;
        }

        .small {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.55);
            margin-top: 12px;
        }
    </style>
</head>

<body>
<div id="dimOverlay"></div>
<div class="card">
    <div class="debug-bar" id="debugBar">
        <span class="label">Debug:</span>
        <button id="debugTrial1">Start Trial 1</button>
        <button id="debugTrial2">Start Trial 2</button>
        <button id="debugTrial3">Start Trial 3</button>
    </div>
    <h1 id="title">Birthday mission ðŸŽ‚</h1>
    <p id="subtitle">Are you ready to know where we are going?</p>

    <div class="stage" id="stage">
        <div class="buttons">
            <button id="yesBtn">HOLD YES ðŸ˜„</button>
        </div>
    </div>

    <div class="progress" id="progress">
        <div></div>
    </div>
    <span class="progress-label" id="progressLabel">0%</span>
</div>
<div id="reveal">
    <div id="confetti"></div>
    <h2>Tenerife ðŸŒ‹ðŸŒ´</h2>
</div>

<script>
    const stage = document.getElementById("stage");
    const yesBtn = document.getElementById("yesBtn");
    const subtitle = document.getElementById("subtitle");
    const debugTrial1 = document.getElementById("debugTrial1");
    const debugTrial2 = document.getElementById("debugTrial2");
    const debugTrial3 = document.getElementById("debugTrial3");
    const dimOverlay = document.getElementById("dimOverlay");
    const reveal = document.getElementById("reveal");
    const confetti = document.getElementById("confetti");

    const progressWrap = document.getElementById("progress");
    const progressBar = progressWrap.querySelector("div");
    const progressLabel = document.getElementById("progressLabel");

    function clamp(n, min, max) {
        return Math.max(min, Math.min(max, n));
    }

    function lerp(a, b, t) {
        return a + (b - a) * t;
    }

    function smoothstep(t) {
        return t * t * (3 - 2 * t);
    }

    function setProgress(pct) {
        const value = clamp(pct, 0, 100);
        progressBar.style.width = value.toFixed(1) + "%";
        progressLabel.textContent = Math.round(value) + "%";
    }

    function stageRect() {
        return stage.getBoundingClientRect();
    }

    function setYesPosition(x, y) {
        const rect = stageRect();
        const b = yesBtn.getBoundingClientRect();

        const nx = clamp(x, 8, rect.width - b.width - 8);
        const ny = clamp(y, 8, rect.height - b.height - 8);

        yesBtn.style.left = nx + "px";
        yesBtn.style.top = ny + "px";
    }

    function getYesPos() {
        return { x: yesBtn.offsetLeft, y: yesBtn.offsetTop };
    }

    function centerYesButton() {
        const rect = stageRect();
        const b = yesBtn.getBoundingClientRect();
        setYesPosition(Math.round((rect.width - b.width) / 2), Math.round((rect.height - b.height) / 2));
    }

    function setTrial3Lines(lines) {
        trial3Lines = [...lines];
        subtitle.innerHTML = trial3Lines.join("<br>");
    }

    function addTrial3Line(line) {
        trial3Lines.push(line);
        subtitle.innerHTML = trial3Lines.join("<br>");
    }

    function clearTrial3Timers() {
        trial3Timers.forEach((id) => clearTimeout(id));
        trial3Timers = [];
    }

    function setTrial3Timer(fn, delay) {
        const id = setTimeout(fn, delay);
        trial3Timers.push(id);
        return id;
    }

    function showDim(show) {
        dimOverlay.classList.toggle("show", show);
    }

    function showReveal(show) {
        reveal.classList.toggle("show", show);
    }

    function spawnConfetti() {
        confetti.innerHTML = "";
        const colors = ["#f97316", "#fde047", "#22c55e", "#60a5fa", "#f472b6"];
        const pieces = 80;
        for (let i = 0; i < pieces; i += 1) {
            const piece = document.createElement("div");
            piece.className = "confetti-piece";
            piece.style.left = Math.random() * 100 + "vw";
            piece.style.background = colors[i % colors.length];
            piece.style.animationDelay = Math.random() * 1.2 + "s";
            piece.style.animationDuration = 2.2 + Math.random() * 1.8 + "s";
            confetti.appendChild(piece);
        }
    }

    // Trial state
    let currentTrial = 1;
    let holding = false;
    let trialEnded = false;
    let nextTrialReady = false;
    let holdStartMs = 0;
    let rafId = null;
    let nextTrialTimer = null;

    // Trial 2 state
    let trial2TapCount = 0;
    let trial2Step = "normal";
    let trial2DecimalIndex = 1;
    let trial2ByTwoValue = 0;
    let trial2NextReady = false;
    let trial2Timer = null;

    // Trial 3 state
    let trial3Step = "intro";
    let trial3Timers = [];
    let trial3Progress = 0;
    let trial3AnimId = null;
    let trial3Lines = [];

    // Motion base
    let baseX = 0;
    let baseY = 0;

    function startTrial1() {
        currentTrial = 1;
        clearTrial3Timers();
        if (trial3AnimId) cancelAnimationFrame(trial3AnimId);
        showDim(false);
        showReveal(false);
        trial3Lines = [];
        subtitle.textContent = "Trial 1: press and hold YES for 30 seconds.";
        progressWrap.style.display = "block";
        progressLabel.style.display = "block";
        setProgress(0);

        yesBtn.textContent = "HOLD YES ðŸ˜„";
        yesBtn.classList.remove("neutral");
        yesBtn.classList.remove("smooth");
        trialEnded = false;
        nextTrialReady = false;
        if (nextTrialTimer) {
            clearTimeout(nextTrialTimer);
            nextTrialTimer = null;
        }
        centerYesButton();
    }

    function startTrial2() {
        currentTrial = 2;
        clearTrial3Timers();
        if (trial3AnimId) cancelAnimationFrame(trial3AnimId);
        showDim(false);
        showReveal(false);
        trial3Lines = [];
        trial2TapCount = 0;
        trial2Step = "normal";
        trial2DecimalIndex = 1;
        trial2ByTwoValue = 0;
        trial2NextReady = false;
        if (trial2Timer) {
            clearTimeout(trial2Timer);
            trial2Timer = null;
        }
        trialEnded = false;
        nextTrialReady = false;

        subtitle.textContent = "Ok, that one was unfair. This one is easy. Just tap YES 5 times.";
        progressWrap.style.display = "none";
        progressLabel.style.display = "none";
        yesBtn.textContent = "YES 0/5";
        yesBtn.classList.remove("neutral");
        yesBtn.classList.remove("smooth");
        centerYesButton();
    }

    function startTrial3() {
        currentTrial = 3;
        trial3Step = "intro";
        trial3Progress = 0;
        clearTrial3Timers();
        if (trial3AnimId) cancelAnimationFrame(trial3AnimId);
        showDim(false);
        showReveal(false);

        setTrial3Lines(["Ok. No tricks this time."]);
        progressWrap.style.display = "none";
        progressLabel.style.display = "none";
        setProgress(0);
        yesBtn.textContent = "YES";
        yesBtn.classList.remove("neutral");
        yesBtn.classList.remove("smooth");
        centerYesButton();

        setTrial3Timer(() => {
            if (currentTrial !== 3) return;
            addTrial3Line("Just one honest question.");
            trial3Step = "question1Ready";
        }, 1200);
    }

    function animateProgressTo(target, duration, onDone) {
        const start = performance.now();
        const from = trial3Progress;
        const delta = target - from;

        const step = (now) => {
            const t = clamp((now - start) / duration, 0, 1);
            const eased = t * (2 - t);
            trial3Progress = from + delta * eased;
            setProgress(trial3Progress);
            if (t < 1) {
                trial3AnimId = requestAnimationFrame(step);
            } else if (onDone) {
                onDone();
            }
        };
        trial3AnimId = requestAnimationFrame(step);
    }

    function runTrial3Progress() {
        trial3Step = "progress";
        progressWrap.style.display = "block";
        progressLabel.style.display = "block";
        setProgress(0);
        trial3Progress = 0;

        animateProgressTo(99, 3400, () => {
            setTrial3Timer(() => {
                animateProgressTo(92, 650, () => {
                    animateProgressTo(97, 1300, () => {
                        setTrial3Timer(() => {
                            animateProgressTo(98, 900, () => {
                                setTrial3Timer(() => {
                                    animateProgressTo(99, 800, () => {
                                        setTrial3Timer(() => {
                                            animateProgressTo(100, 900, () => {
                                                revealDestination();
                                            });
                                        }, 400);
                                    });
                                }, 1000);
                            });
                        }, 1000);
                    });
                });
            }, 350);
        });
    }

    function revealDestination() {
        trial3Step = "reveal";
        showDim(false);
        showReveal(true);
        spawnConfetti();
        if (navigator.vibrate) navigator.vibrate([80, 40, 80]);
    }

    function handleTrial3Tap() {
        if (trial3Step === "progress" || trial3Step === "reveal") return;

        if (trial3Step === "intro" || trial3Step === "question1Ready") {
            clearTrial3Timers();
            const introLine = "Just one honest question.";
            if (!trial3Lines.includes(introLine)) {
                addTrial3Line(introLine);
            }
            addTrial3Line("Do you trust me?");
            trial3Step = "question1Asked";
            setTrial3Timer(() => {
                if (currentTrial !== 3) return;
                addTrial3Line("And are you ready to go on an adventure with me?");
                trial3Step = "question2Ready";
            }, 1000);
            return;
        }

        if (trial3Step === "question2Ready") {
            clearTrial3Timers();
            trial3Step = "fakeEnding";
            setTrial3Lines(["Alright then."]);
            setTrial3Timer(() => {
                if (currentTrial !== 3) return;
                addTrial3Line("Let's go.");
            }, 700);
            setTrial3Timer(() => {
                if (currentTrial !== 3) return;
                setTrial3Lines(["Actually..."]);
            }, 1400);
            setTrial3Timer(() => {
                if (currentTrial !== 3) return;
                addTrial3Line("One last thing.");
                yesBtn.textContent = "Reveal destination";
                centerYesButton();
                trial3Step = "revealButton";
            }, 2100);
            return;
        }

        if (trial3Step === "revealButton") {
            runTrial3Progress();
        }
    }

    function handleTrial2Tap() {
        if (trial2Step === "done") return;

        if (trial2Step === "goBack") {
            trial2Step = "byTwo";
            trial2ByTwoValue = 0;
            subtitle.textContent = "Ok, let's go 2 by 2, otherwise we'll never make it";
            yesBtn.textContent = "YES 0/5";
            yesBtn.classList.remove("neutral");
            return;
        }

        if (trial2Step === "byTwo") {
            trial2ByTwoValue += 2;
            yesBtn.textContent = `YES ${trial2ByTwoValue}/5`;
            if (trial2ByTwoValue >= 6) {
                trial2Step = "done";
                subtitle.textContent =
                    "I guess you either can't count or you really don't want to go... should we go to the next trial?";
                yesBtn.classList.add("neutral");
                trial2NextReady = false;
                trial2Timer = setTimeout(() => {
                    yesBtn.textContent = "Go to next trial";
                    centerYesButton();
                    trial2NextReady = true;
                }, 3000);
            }
            return;
        }

        trial2TapCount += 1;

        if (trial2TapCount <= 4) {
            if (trial2TapCount === 1) subtitle.textContent = "Good.";
            else if (trial2TapCount === 2) subtitle.textContent = "Nice.";
            else if (trial2TapCount === 3) subtitle.textContent = "Almost there.";
            yesBtn.textContent = `YES ${trial2TapCount}/5`;
            return;
        }

        if (trial2TapCount === 5) {
            trial2Step = "backedOnce";
            subtitle.textContent = "Huh? Why did you go back?";
            yesBtn.textContent = "YES 3/5";
            return;
        }

        if (trial2TapCount === 6) {
            trial2Step = "decimals";
            trial2DecimalIndex = 1;
            subtitle.textContent = "Ok. Keep going.";
            yesBtn.textContent = "YES 4/5";
            return;
        }

        if (trial2Step === "decimals") {
            if (trial2DecimalIndex <= 9) {
                yesBtn.textContent = `YES 4.${trial2DecimalIndex}/5`;
                trial2DecimalIndex += 1;
                if (trial2DecimalIndex === 10) {
                    trial2Step = "skipFiveNext";
                }
                return;
            }
        }

        if (trial2Step === "skipFiveNext") {
            subtitle.textContent = "Cmon dude, you skipped 5! Go back.";
            trial2Step = "sixPause";
            yesBtn.textContent = "YES 6/5";
            yesBtn.classList.add("neutral");
            if (trial2Timer) clearTimeout(trial2Timer);
            trial2Timer = setTimeout(() => {
                yesBtn.textContent = "Go back";
                trial2Step = "goBack";
            }, 2000);
        }
    }

    function failTrial1() {
        holding = false;
        cancelAnimationFrame(rafId);
        rafId = null;

        yesBtn.style.transform = "scale(1)";
        yesBtn.textContent = "You can let go now";
        yesBtn.classList.add("neutral");
        yesBtn.classList.add("smooth");
        centerYesButton();
        setProgress(100);

        subtitle.textContent =
            "Well... you didn't make it. Do you even care about this?! Nevermind, let's try something else...";

        if (navigator.vibrate) navigator.vibrate([50, 80, 50]);
        trialEnded = true;
        nextTrialReady = false;

        nextTrialTimer = setTimeout(() => {
            yesBtn.textContent = "Go to next trial";
            centerYesButton();
            nextTrialReady = true;
        }, 3500);
    }

    // Motion curve per phase
    function motionAt(t) {
        // t in seconds since hold started, expected 0..30
        const rect = stageRect();

        // 0-10s: still
        if (t < 10) {
            return { x: baseX, y: baseY };
        }

        // Helper
        const twoPi = Math.PI * 2;
        const sin = Math.sin;

        const phase1 = (time) => {
            const p = clamp((time - 10) / 5, 0, 1);
            const amp = 30 + 30 * p; // 30..60 px
            const speed = 0.35 + 0.4 * p; // 0.35..0.75
            return {
                x: baseX + amp * sin(twoPi * speed * (time - 10)),
                y: baseY,
            };
        };

        const phase2 = (time) => {
            const p = clamp((time - 15) / 5, 0, 1);
            const amp = 70 + 45 * p; // 70..115
            const speed = 1.0 + 1.2 * p; // 1.0..2.2
            return {
                x: baseX + amp * sin(twoPi * speed * (time - 10)),
                y: baseY,
            };
        };

        const phase3 = (time) => {
            const p = clamp((time - 20) / 5, 0, 1);
            const ampY = 60 + 60 * p; // 60..120
            const speedY = 1.3 + 1.3 * p; // 1.3..2.6
            const ampX = 35 + 35 * p;
            const speedX = 1.8 + 1.2 * p;
            return {
                x: baseX + ampX * sin(twoPi * speedX * (time - 10)),
                y: baseY + ampY * sin(twoPi * speedY * (time - 10)),
            };
        };

        const phase4 = (time) => {
            const p = clamp((time - 25) / 5, 0, 1);
            const amp = 140 + 120 * p; // 140..260
            const speed1 = 3.0 + 3.0 * p; // 3..6
            const speed2 = 4.0 + 4.0 * p; // 4..8
            return {
                x:
                    baseX +
                    amp * 0.55 * sin(twoPi * speed1 * (time - 10)) +
                    amp * 0.35 * sin(twoPi * (speed2 * 0.9) * (time - 10) + 1.2) +
                    (Math.random() * 18 - 9) * (0.2 + 0.8 * p),
                y:
                    baseY +
                    amp * 0.45 * sin(twoPi * (speed1 * 1.1) * (time - 10) + 0.7) +
                    amp * 0.40 * sin(twoPi * speed2 * (time - 10) + 2.3) +
                    (Math.random() * 18 - 9) * (0.2 + 0.8 * p),
            };
        };

        const blendWindow = 0.7;
        const blend = (from, to, time, start) => {
            const u = smoothstep(clamp((time - start) / blendWindow, 0, 1));
            return { x: lerp(from.x, to.x, u), y: lerp(from.y, to.y, u) };
        };

        let pos;
        if (t < 15) {
            pos = phase1(t);
        } else if (t < 15 + blendWindow) {
            pos = blend(phase1(t), phase2(t), t, 15);
        } else if (t < 20) {
            pos = phase2(t);
        } else if (t < 20 + blendWindow) {
            pos = blend(phase2(t), phase3(t), t, 20);
        } else if (t < 25) {
            pos = phase3(t);
        } else if (t < 25 + blendWindow) {
            pos = blend(phase3(t), phase4(t), t, 25);
        } else {
            pos = phase4(t);
        }

        let x = pos.x;
        let y = pos.y;

        // Clamp within stage bounds
        const b = yesBtn.getBoundingClientRect();
        const maxX = rect.width - b.width - 8;
        const maxY = rect.height - b.height - 8;

        x = clamp(x, 8, maxX);
        y = clamp(y, 8, maxY);

        return { x, y };
    }

    function tickTrial1() {
        if (!holding) return;

        const now = performance.now();
        const elapsedMs = now - holdStartMs;
        const elapsedS = elapsedMs / 1000;

        // Update progress
        const pct = clamp((elapsedS / 30) * 100, 0, 100);
        setProgress(pct);

        // Update subtitle at key moments
        if (elapsedS < 10) {
            subtitle.textContent = "Ok. Just hold it... 30 seconds.";
        } else if (elapsedS < 15) {
            subtitle.textContent = "Oh! It moved. Keep holding.";
        } else if (elapsedS < 20) {
            subtitle.textContent = "It is getting faster ðŸ˜ˆ";
        } else if (elapsedS < 25) {
            subtitle.textContent = "Up and down now. Do not let go!";
        } else {
            subtitle.textContent = "HAHAHAHAHAHA";
        }

        // Move the button according to phase
        const pos = motionAt(elapsedS);
        setYesPosition(pos.x, pos.y);

        // Fail at 30s no matter what
        if (elapsedS >= 30) {
            failTrial1();
            return;
        }

        rafId = requestAnimationFrame(tickTrial1);
    }

    // Holding mechanics
    yesBtn.addEventListener("pointerdown", (e) => {
        if (currentTrial !== 1 || trialEnded) return;
        e.preventDefault();
        yesBtn.setPointerCapture?.(e.pointerId);

        holding = true;
        holdStartMs = performance.now();
        yesBtn.classList.remove("smooth");

        const p = getYesPos();
        baseX = p.x;
        baseY = p.y;

        // Make it feel pressed
        yesBtn.style.transform = "scale(0.92)";

        if (navigator.vibrate) navigator.vibrate(20);

        cancelAnimationFrame(rafId);
        rafId = requestAnimationFrame(tickTrial1);
    });

    function endHold() {
        if (currentTrial !== 1) return;
        if (!holding) return;

        holding = false;
        cancelAnimationFrame(rafId);
        rafId = null;

        yesBtn.style.transform = "scale(1)";

        subtitle.textContent = "You let go. That is... tragic. Try again.";
        if (navigator.vibrate) navigator.vibrate([30, 40, 30]);

        // Reset progress + reposition to center
        setProgress(0);
        centerYesButton();
    }

    yesBtn.addEventListener("pointerup", () => endHold());
    yesBtn.addEventListener("pointercancel", () => endHold());
    yesBtn.addEventListener("lostpointercapture", () => endHold());

    yesBtn.addEventListener("click", () => {
        if (holding) return;
        if (currentTrial === 1) {
            if (!trialEnded || !nextTrialReady) return;
            startTrial2();
        } else if (currentTrial === 2) {
            if (trial2NextReady) {
                startTrial3();
                return;
            }
            handleTrial2Tap();
        } else if (currentTrial === 3) {
            handleTrial3Tap();
        }
    });

    // Start
    startTrial1();

    // Debug controls (temporary)
    debugTrial1.addEventListener("click", () => startTrial1());
    debugTrial2.addEventListener("click", () => startTrial2());
    debugTrial3.addEventListener("click", () => startTrial3());
</script>
</body>
</html>
